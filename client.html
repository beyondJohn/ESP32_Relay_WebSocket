<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client</title>
</head>

<body>
    <input type="button" value="Retract" onclick="on()">
    <input type="button" value="Inject" onclick="off()">
    <br><br>
    <input type="button" value="Enable" onclick="enable()">
    <input type="button" value="Disable" onclick="disable()">
    <br><br>
    <input type="button" value="Dispense 10ml" onclick="dispense10Mil()">
    <div id="divTemp" style="padding: 15px 0;"></div>
    <script>
        const WS_URL = 'ws:///192.82.251.138:8888';
        const ws = new WebSocket(WS_URL);

        let urlObject;
        ws.onopen = () => console.log(`Connected to ${WS_URL}`);
        ws.onmessage = message => {
            let myDataJson;
            try {
                myDataJson = JSON.parse(message.data);
                if (myDataJson["T"] !== undefined) {
                    let tempDiv = document.getElementById("divTemp");
                    const myTime = new Date();
                    tempDiv.innerHTML = "Temperature: " + myDataJson["T"] + "&deg; <br>" 
                    + "Humidity: " + myDataJson["H"] + "&#37;  <br> Timestamp: " +
                    + (myTime.getMonth() + 1) + "/" + myTime.getDay() + "/" + myTime.getFullYear() + " " + myTime.toTimeString();
                }
            }
            catch {
                // this try/catch is not needed past 2/1/2021, all message.data will parse moving forward   
            }

        }
        const on = function () {
            ws.send('hey hi ho')
        }
        const off = function () {
            ws.send('ha ha ha')
        }
        const enable = function () {
            ws.send('on')
        }
        const disable = function () {
            ws.send('off')
        }
        const dispense10Mil = function () {
            ws.send("dispense10");
        }
    </script>
</body>

</html>